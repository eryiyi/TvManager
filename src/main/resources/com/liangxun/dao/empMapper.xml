<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC
        "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.liangxunwang.unimanager.dao.EmpDao">
    <resultMap id="emp" type="com.liangxunwang.unimanager.model.Emp">
        <id column="mm_emp_id" property="mm_emp_id"/>
        <result column="mm_emp_mobile" property="mm_emp_mobile"/>
        <result column="mm_emp_nickname" property="mm_emp_nickname"/>
        <result column="mm_emp_card" property="mm_emp_card"/>
        <result column="mm_emp_cover" property="mm_emp_cover"/>
        <result column="mm_emp_password" property="mm_emp_password"/>
        <result column="mm_emp_company" property="mm_emp_company"/>
        <result column="mm_emp_provinceId" property="mm_emp_provinceId"/>
        <result column="mm_emp_cityId" property="mm_emp_cityId"/>
        <result column="mm_emp_countryId" property="mm_emp_countryId"/>
        <result column="mm_emp_regtime" property="mm_emp_regtime"/>
        <result column="is_login" property="is_login"/>
        <result column="is_use" property="is_use"/>
        <result column="lat" property="lat"/>
        <result column="lng" property="lng"/>
        <result column="ischeck" property="ischeck"/>
        <result column="is_upate_profile" property="is_upate_profile"/>
        <result column="userId" property="userId"/>
        <result column="channelId" property="channelId"/>
        <result column="deviceType" property="deviceType"/>
        <result column="mm_emp_email" property="mm_emp_email"/>
        <result column="mm_emp_sex" property="mm_emp_sex"/>
        <result column="mm_emp_birthday" property="mm_emp_birthday"/>
        <result column="mm_emp_techang" property="mm_emp_techang"/>
        <result column="mm_emp_xingqu" property="mm_emp_xingqu"/>
        <result column="mm_emp_detail" property="mm_emp_detail"/>
        <result column="mm_hangye_id" property="mm_hangye_id"/>
        <result column="top_number" property="top_number"/>
        <result column="mm_emp_weixin" property="mm_emp_weixin"/>
        <result column="mm_emp_qq" property="mm_emp_qq"/>
        <result column="mm_emp_age" property="mm_emp_age"/>
        <result column="hxusername" property="hxusername"/>
        <result column="push_id" property="pushId"/>
        <result column="mm_emp_native" property="mm_emp_native"/>
        <result column="mm_emp_motto" property="mm_emp_motto"/>
        <result column="mm_emp_type" property="mm_emp_type"/>
        <result column="mm_emp_bg" property="mm_emp_bg"/>
    </resultMap>
    <resultMap id="emp_vo" type="com.liangxunwang.unimanager.mvc.vo.EmpVO">
        <id column="mm_emp_id" property="mm_emp_id"/>
        <result column="mm_emp_mobile" property="mm_emp_mobile"/>
        <result column="mm_emp_nickname" property="mm_emp_nickname"/>
        <result column="mm_emp_card" property="mm_emp_card"/>
        <result column="mm_emp_cover" property="mm_emp_cover"/>
        <result column="mm_emp_password" property="mm_emp_password"/>
        <result column="mm_emp_company" property="mm_emp_company"/>
        <result column="mm_emp_provinceId" property="mm_emp_provinceId"/>
        <result column="mm_emp_cityId" property="mm_emp_cityId"/>
        <result column="mm_emp_countryId" property="mm_emp_countryId"/>
        <result column="mm_emp_regtime" property="mm_emp_regtime"/>
        <result column="is_login" property="is_login"/>
        <result column="is_use" property="is_use"/>
        <result column="lat" property="lat"/>
        <result column="lng" property="lng"/>
        <result column="ischeck" property="ischeck"/>
        <result column="is_upate_profile" property="is_upate_profile"/>
        <result column="userId" property="userId"/>
        <result column="channelId" property="channelId"/>
        <result column="deviceType" property="deviceType"/>
        <result column="mm_emp_email" property="mm_emp_email"/>
        <result column="mm_emp_sex" property="mm_emp_sex"/>
        <result column="mm_emp_birthday" property="mm_emp_birthday"/>
        <result column="mm_emp_techang" property="mm_emp_techang"/>
        <result column="mm_emp_xingqu" property="mm_emp_xingqu"/>
        <result column="mm_emp_detail" property="mm_emp_detail"/>
        <result column="mm_hangye_id" property="mm_hangye_id"/>
        <result column="top_number" property="top_number"/>
        <result column="mm_emp_weixin" property="mm_emp_weixin"/>
        <result column="mm_emp_qq" property="mm_emp_qq"/>
        <result column="mm_emp_age" property="mm_emp_age"/>
        <result column="hxusername" property="hxusername"/>
        <result column="push_id" property="pushId"/>
        <result column="mm_emp_native" property="mm_emp_native"/>
        <result column="mm_emp_motto" property="mm_emp_motto"/>
        <result column="mm_emp_bg" property="mm_emp_bg"/>

        <result column="levelName" property="levelName"/>
        <result column="mm_level_num" property="mm_level_num"/>
        <result column="provinceName" property="provinceName"/>
        <result column="cityName" property="cityName"/>
        <result column="areaName" property="areaName"/>
        <result column="mm_hangye_name" property="mm_hangye_name"/>
        <result column="mm_emp_type" property="mm_emp_type"/>
    </resultMap>


    <resultMap id="my_member_dianpu" type="com.liangxunwang.unimanager.mvc.vo.EmpDianpu">
        <id column="mm_emp_id" property="mm_emp_id"/>
        <result column="mm_emp_mobile" property="mm_emp_mobile"/>
        <result column="mm_emp_nickname" property="mm_emp_nickname"/>
        <result column="mm_emp_card" property="mm_emp_card"/>
        <result column="mm_emp_cover" property="mm_emp_cover"/>
        <result column="mm_emp_password" property="mm_emp_password"/>
        <result column="mm_emp_company" property="mm_emp_company"/>
        <result column="mm_emp_provinceId" property="mm_emp_provinceId"/>
        <result column="mm_emp_cityId" property="mm_emp_cityId"/>
        <result column="mm_emp_countryId" property="mm_emp_countryId"/>
        <result column="mm_emp_regtime" property="mm_emp_regtime"/>
        <result column="is_login" property="is_login"/>
        <result column="is_use" property="is_use"/>
        <result column="lat" property="lat"/>
        <result column="lng" property="lng"/>
        <result column="ischeck" property="ischeck"/>
        <result column="is_upate_profile" property="is_upate_profile"/>
        <result column="userId" property="userId"/>
        <result column="channelId" property="channelId"/>
        <result column="deviceType" property="deviceType"/>
        <result column="mm_emp_email" property="mm_emp_email"/>
        <result column="mm_emp_sex" property="mm_emp_sex"/>
        <result column="mm_emp_birthday" property="mm_emp_birthday"/>
        <result column="mm_emp_techang" property="mm_emp_techang"/>
        <result column="mm_emp_xingqu" property="mm_emp_xingqu"/>
        <result column="mm_emp_detail" property="mm_emp_detail"/>
        <result column="mm_hangye_id" property="mm_hangye_id"/>
        <result column="top_number" property="top_number"/>
        <result column="mm_emp_weixin" property="mm_emp_weixin"/>
        <result column="mm_emp_qq" property="mm_emp_qq"/>
        <result column="mm_emp_age" property="mm_emp_age"/>
        <result column="hxusername" property="hxusername"/>
        <result column="push_id" property="pushId"/>
        <result column="mm_emp_native" property="mm_emp_native"/>
        <result column="mm_emp_motto" property="mm_emp_motto"/>
        <result column="mm_emp_bg" property="mm_emp_bg"/>

        <result column="levelName" property="levelName"/>
        <result column="mm_level_num" property="mm_level_num"/>
        <result column="provinceName" property="provinceName"/>
        <result column="cityName" property="cityName"/>
        <result column="areaName" property="areaName"/>
        <result column="mm_hangye_name" property="mm_hangye_name"/>
        <result column="mm_emp_type" property="mm_emp_type"/>

        <result column="mm_ad_title" property="mm_ad_title"/>
        <result column="mm_ad_pic" property="mm_ad_pic"/>
        <result column="mm_ad_url" property="mm_ad_url"/>

        <result column="pingtai_url" property="pingtai_url"/>
        <result column="school_three_pingtai_pic" property="school_three_pingtai_pic"/>
        <result column="school_three_pingtai_name" property="school_three_pingtai_name"/>

        <result column="company_pic" property="company_pic"/>
        <result column="shouhui" property="shouhui"/>
        <result column="yingye_time_end" property="yingye_time_end"/>
        <result column="yingye_time_start" property="yingye_time_start"/>
        <result column="company_name" property="company_name"/>
        <result column="company_detail" property="company_detail"/>
        <result column="company_tel" property="company_tel"/>
        <result column="company_person" property="company_person"/>
        <result column="company_address" property="company_address"/>
        <result column="lng_company" property="lng_company"/>
        <result column="lat_company" property="lat_company"/>
    </resultMap>


    <select id="listMemberInfoByUsername" resultMap="emp_vo" parameterType="String">
        SELECT * from mm_emp WHERE hxusername IN
        <foreach collection="hxUsername" item="username" open="(" separator="," close=")">
            #{username}
        </foreach>
    </select>

    <select id="listMemberByName" resultMap="emp_vo">
        SELECT sn.* ,hatp.province as provinceName, hatc.city as cityName, hata.area as areaName, lhangye.mm_hangye_name as mm_hangye_name  from mm_emp sn
        LEFT JOIN hat_province hatp ON sn.mm_emp_provinceId=hatp.provinceID
        LEFT JOIN hat_city hatc ON sn.mm_emp_cityId=hatc.cityID
        LEFT JOIN hat_area hata ON sn.mm_emp_countryId=hata.areaID
        LEFT JOIN guiren_hangye lhangye ON lhangye.mm_hangye_id=sn.mm_hangye_id
        WHERE 1=1
        <if test="ischeck != null and ischeck != ''">
            AND sn.ischeck = #{ischeck}
        </if>
        <if test="keyword != null and keyword != ''">
            AND  (sn.mm_emp_mobile = #{keyword} OR sn.mm_emp_nickname like CONCAT('%',#{keyword},'%') OR  sn.mm_emp_company like CONCAT('%',#{keyword},'%'))
        </if>
        ORDER BY sn.mm_emp_regtime DESC limit #{index},#{size}
    </select>

    <select id="listsRenmai" resultMap="emp_vo">
        SELECT sn.* ,hatp.province as provinceName, hatc.city as cityName, hata.area as areaName, lhangye.mm_hangye_name as mm_hangye_name  from mm_emp sn
        LEFT JOIN hat_province hatp ON sn.mm_emp_provinceId=hatp.provinceID
        LEFT JOIN hat_city hatc ON sn.mm_emp_cityId=hatc.cityID
        LEFT JOIN hat_area hata ON sn.mm_emp_countryId=hata.areaID
        LEFT JOIN guiren_hangye lhangye ON lhangye.mm_hangye_id=sn.mm_hangye_id
        WHERE 1=1
        <if test="mm_hangye_id != null and mm_hangye_id != ''">
            AND sn.mm_hangye_id = #{mm_hangye_id}
        </if>
        <if test="mm_emp_cityId != null and mm_emp_cityId != ''">
            AND sn.mm_emp_cityId = #{mm_emp_cityId}
        </if>
        <if test="mm_emp_countryId != null and mm_emp_countryId != ''">
            AND sn.mm_emp_countryId = #{mm_emp_countryId}
        </if>
        <if test="keywords != null and keywords != ''">
            AND  (sn.mm_emp_mobile = #{keywords} OR sn.mm_emp_nickname like CONCAT('%',#{keywords},'%') OR  sn.mm_emp_company like CONCAT('%',#{keywords},'%') OR  sn.mm_emp_techang like CONCAT('%',#{keywords},'%') OR  sn.mm_emp_xingqu like CONCAT('%',#{keywords},'%') OR  sn.mm_emp_motto like CONCAT('%',#{keywords},'%'))
        </if>
        ORDER  by sn.mm_emp_regtime DESC

        limit #{index},#{size}
    </select>

    <select id="count" resultType="Long">
        SELECT count(sn.mm_emp_id) FROM mm_emp sn
        LEFT JOIN hat_province hatp ON sn.mm_emp_provinceId=hatp.provinceID
        LEFT JOIN hat_city hatc ON sn.mm_emp_cityId=hatc.cityID
        LEFT JOIN hat_area hata ON sn.mm_emp_countryId=hata.areaID
        WHERE 1=1

        <if test="ischeck != null and ischeck != ''">
            AND sn.ischeck = #{ischeck}
        </if>

        <if test="keyword != null and keyword != ''">
            AND  (sn.mm_emp_mobile = #{keyword} OR sn.mm_emp_nickname like CONCAT('%',#{keyword},'%') OR  sn.mm_emp_company like CONCAT('%',#{keyword},'%'))
        </if>
    </select>

    <select id="countDay" resultType="Long">
        SELECT count(sn.mm_emp_id) FROM mm_emp sn
        WHERE 1=1
        <if test="mm_emp_regtime != null and mm_emp_regtime != ''">
            AND sn.mm_emp_regtime = #{mm_emp_regtime}
        </if>
    </select>

    <update id="update" parameterType="com.liangxunwang.unimanager.model.Emp">
        UPDATE mm_emp SET
        ischeck=#{ischeck}
        WHERE mm_emp_id=#{mm_emp_id}
    </update>

    <select id="findById" resultMap="emp_vo" parameterType="String">
         SELECT sn.* , hatp.province as provinceName, hatc.city as cityName, hata.area as areaName , lhangye.mm_hangye_name as mm_hangye_name from mm_emp sn
        LEFT JOIN hat_province hatp ON sn.mm_emp_provinceId=hatp.provinceID
        LEFT JOIN hat_city hatc ON sn.mm_emp_cityId=hatc.cityID
        LEFT JOIN hat_area hata ON sn.mm_emp_countryId=hata.areaID
        LEFT JOIN guiren_hangye lhangye ON lhangye.mm_hangye_id=sn.mm_hangye_id
        WHERE sn.mm_emp_id=#{mm_emp_id}
    </select>


    <select id="findByMobile" parameterType="String" resultMap="emp_vo">
        SELECT sn.* , hatp.province as provinceName, hatc.city as cityName, hata.area as areaName , lhangye.mm_hangye_name as mm_hangye_name from mm_emp sn
        LEFT JOIN hat_province hatp ON sn.mm_emp_provinceId=hatp.provinceID
        LEFT JOIN hat_city hatc ON sn.mm_emp_cityId=hatc.cityID
        LEFT JOIN hat_area hata ON sn.mm_emp_countryId=hata.areaID
         LEFT JOIN guiren_hangye lhangye ON lhangye.mm_hangye_id=sn.mm_hangye_id
        WHERE sn.mm_emp_mobile=#{mm_emp_mobile}
    </select>

    <select id="findByHxId" parameterType="String" resultMap="emp_vo">
        SELECT sn.* , hatp.province as provinceName, hatc.city as cityName, hata.area as areaName , lhangye.mm_hangye_name as mm_hangye_name from mm_emp sn
        LEFT JOIN hat_province hatp ON sn.mm_emp_provinceId=hatp.provinceID
        LEFT JOIN hat_city hatc ON sn.mm_emp_cityId=hatc.cityID
        LEFT JOIN hat_area hata ON sn.mm_emp_countryId=hata.areaID
         LEFT JOIN guiren_hangye lhangye ON lhangye.mm_hangye_id=sn.mm_hangye_id
        WHERE sn.hxusername=#{hxusername}
    </select>

    <insert id="save" parameterType="com.liangxunwang.unimanager.model.Emp">
        INSERT INTO mm_emp(mm_emp_motto,mm_emp_native,mm_hangye_id,mm_emp_email,mm_emp_sex,mm_emp_birthday,mm_emp_techang, mm_emp_cover,mm_emp_id, mm_emp_mobile, mm_emp_nickname,mm_emp_card, mm_emp_password, mm_emp_company, mm_emp_provinceId, mm_emp_cityId, mm_emp_countryId, mm_emp_regtime, is_login, lat, lng, ischeck,is_upate_profile,top_number,mm_emp_weixin,mm_emp_qq,mm_emp_age,hxusername)
        VALUES (#{mm_emp_motto,jdbcType=VARCHAR},#{mm_emp_native,jdbcType=VARCHAR},#{mm_hangye_id,jdbcType=VARCHAR},#{mm_emp_email,jdbcType=VARCHAR},#{mm_emp_sex,jdbcType=VARCHAR},#{mm_emp_birthday,jdbcType=VARCHAR},#{mm_emp_techang,jdbcType=VARCHAR},#{mm_emp_cover,jdbcType=VARCHAR},#{mm_emp_id}, #{mm_emp_mobile},#{mm_emp_nickname,jdbcType=VARCHAR}, #{mm_emp_card,jdbcType=VARCHAR}, #{mm_emp_password},#{mm_emp_company,jdbcType=VARCHAR},#{mm_emp_provinceId,jdbcType=VARCHAR},#{mm_emp_cityId,jdbcType=VARCHAR},#{mm_emp_countryId,jdbcType=VARCHAR},#{mm_emp_regtime},#{is_login},#{lat,jdbcType=VARCHAR},#{lng,jdbcType=VARCHAR},#{ischeck},'0',#{top_number},#{mm_emp_weixin,jdbcType=VARCHAR},#{mm_emp_qq,jdbcType=VARCHAR},#{mm_emp_age,jdbcType=VARCHAR},#{hxusername})
    </insert>

    <update id="updateLoacation" parameterType="com.liangxunwang.unimanager.model.Emp">
        UPDATE mm_emp SET
        lat=#{lat},
        lng=#{lng}
        WHERE mm_emp_id=#{mm_emp_id}
    </update>

    <update id="updatePwr" parameterType="com.liangxunwang.unimanager.model.Emp">
        UPDATE mm_emp SET
        mm_emp_password=#{mm_emp_password}
        WHERE mm_emp_mobile=#{mm_emp_mobile}
    </update>

    <update id="updateCover" parameterType="com.liangxunwang.unimanager.model.Emp">
        UPDATE mm_emp SET
        mm_emp_cover=#{mm_emp_cover}
        WHERE mm_emp_mobile=#{mm_emp_mobile}
    </update>
    <update id="updateCoverById" parameterType="com.liangxunwang.unimanager.model.Emp">
        UPDATE mm_emp SET
        mm_emp_cover=#{mm_emp_cover}
        WHERE mm_emp_id=#{mm_emp_id}
    </update>

    <select id="listsLocation" resultMap="emp_vo">
        SELECT sn.* , hatp.province as provinceName, hatc.city as cityName, hata.area as areaName  from mm_emp sn
        LEFT JOIN hat_province hatp ON sn.mm_emp_provinceId=hatp.provinceID
        LEFT JOIN hat_city hatc ON sn.mm_emp_cityId=hatc.cityID
        LEFT JOIN hat_area hata ON sn.mm_emp_countryId=hata.areaID
        WHERE 1=1
    </select>

    <select id="findByMobileAndCard" resultMap="emp_vo">
        SELECT sn.* , hatp.province as provinceName, hatc.city as cityName, hata.area as areaName  from mm_emp sn
        LEFT JOIN hat_province hatp ON sn.mm_emp_provinceId=hatp.provinceID
        LEFT JOIN hat_city hatc ON sn.mm_emp_cityId=hatc.cityID
        LEFT JOIN hat_area hata ON sn.mm_emp_countryId=hata.areaID
        WHERE 1=1
        <if test="mm_emp_mobile != null and mm_emp_mobile != ''">
            AND sn.mm_emp_mobile = #{mm_emp_mobile}
        </if>
        <if test="mm_emp_card != null and mm_emp_card != ''">
            AND sn.mm_emp_card = #{mm_emp_card}
        </if>
    </select>

    <update id="updateCheck">
        UPDATE mm_emp SET
        ischeck=#{ischeck}
        WHERE mm_emp_id=#{mm_emp_id}
    </update>

    <update id="updateLogin">
        UPDATE mm_emp SET
        is_login=#{is_login}
        WHERE mm_emp_id=#{mm_emp_id}
    </update>

    <update id="updateProfileMember">
        UPDATE mm_emp SET
        mm_emp_card=#{mm_emp_card},
        mm_emp_cover=#{mm_emp_cover},
        mm_emp_company=#{mm_emp_company},
        is_upate_profile=#{is_upate_profile}
        WHERE mm_emp_id=#{mm_emp_id}
    </update>

    <update id="updateOverTime">
        UPDATE mm_emp SET mm_level_id='358b1e94e2274685b0badf41e22b85c8' WHERE mm_emp_endtime &lt; #{nowTime}
    </update>

    <update id="deleteEmp">
        DELETE FROM mm_emp WHERE mm_emp_id=#{mm_emp_id}
    </update>

    <update id="updatePushId" parameterType="String">
        UPDATE mm_emp set userId=#{userId}, push_id=#{userId}, channelId=#{channelId}, deviceType=#{type} WHERE mm_emp_id=#{id}
    </update>

    <update id="updateMobile">
        UPDATE mm_emp SET
        mm_emp_mobile=#{mm_emp_mobile}
        WHERE mm_emp_id=#{mm_emp_id}
    </update>

    <select id="listtopnumber" resultMap="emp_vo">
        select sn.top_number from mm_emp sn
        WHERE 1=1
        <if test="top_number != null and top_number != ''">
            AND sn.top_number like CONCAT(#{top_number},'%') and LENGTH(sn.top_number) = (LENGTH(#{top_number})+4)
        </if>
        order by  sn.top_number  desc
    </select>

    <select id="findByNumber" resultMap="emp_vo" parameterType="String">
        SELECT sn.*  from mm_emp sn
        WHERE sn.top_number=#{top_number}
    </select>

    <!--查询顶级会员-->
    <select id="listtopnumber2" resultMap="emp_vo">
        select sn.top_number from mm_emp sn
        WHERE 1=1 AND  LENGTH(sn.top_number) = 4
        order by  sn.top_number  desc
    </select>

    <!--根据顶级父标志查询会员集合-->
    <select id="listtopnumber3" resultMap="emp_vo">
        select sn.* from mm_emp sn
        WHERE 1=1
        <if test="top_number != null and top_number != ''">
            AND sn.top_number like CONCAT(#{top_number},'%')
        </if>
    </select>

    <update id="editEmpById" parameterType="com.liangxunwang.unimanager.model.Emp">
        UPDATE mm_emp SET mm_emp_nickname=#{mm_emp_nickname},
        mm_emp_company=#{mm_emp_company},
        mm_emp_email=#{mm_emp_email},
        mm_emp_sex=#{mm_emp_sex},
        mm_emp_techang=#{mm_emp_techang},
        mm_emp_xingqu=#{mm_emp_xingqu},
        mm_emp_age=#{mm_emp_age},
        mm_emp_qq=#{mm_emp_qq},
        mm_emp_weixin=#{mm_emp_weixin},
        mm_emp_motto=#{mm_emp_motto},
        mm_emp_native=#{mm_emp_native},
        mm_emp_provinceId=#{mm_emp_provinceId},
        mm_emp_cityId=#{mm_emp_cityId},
        mm_emp_countryId=#{mm_emp_countryId},
        mm_hangye_id=#{mm_hangye_id},
        mm_emp_detail=#{mm_emp_detail}
        WHERE mm_emp_id=#{mm_emp_id}
    </update>

    <update id="updateEmpCheck" parameterType="com.liangxunwang.unimanager.model.Emp">
        UPDATE mm_emp SET ischeck=#{ischeck}
        WHERE mm_emp_id=#{mm_emp_id}
    </update>

    <update id="changeBusiness">
        update mm_emp set mm_emp_type=#{flag} where mm_emp_id=#{empId}
    </update>

    <select id="listDianPu" resultMap="my_member_dianpu">
        SELECT le.* ,
        lmanager.lat_company as lat_company,
        lmanager.lng_company as lng_company,
        lmanager.company_address as company_address,
        lmanager.company_person as company_person,
        lmanager.company_tel as company_tel,
        lmanager.company_detail as company_detail,
        lmanager.company_name as company_name,
        lmanager.yingye_time_start as yingye_time_start,
        lmanager.yingye_time_end as yingye_time_end,
        lmanager.shouhui as shouhui,
        lmanager.company_pic as company_pic

        --         lad.mm_ad_title as mm_ad_title,
        --         lad.mm_ad_pic as mm_ad_pic,
        --         lad.mm_ad_url as mm_ad_url,
        --
        --         lthree.pingtai_url as pingtai_url,
        --
        --         lthr.school_three_pingtai_pic as school_three_pingtai_pic,
        --         lthr.school_three_pingtai_name as school_three_pingtai_name

        from mm_emp le
        LEFT JOIN manager_info lmanager ON lmanager.emp_id = le.mm_emp_id
        --         LEFT JOIN seller_ad lad ON lad.emp_id = le.emp_id
        --         LEFT JOIN emp_pingtai_mng lthree ON lthree.emp_id = le.emp_id
        --         LEFT JOIN school_three_pingtai lthr ON lthree.school_three_pingtai_id = lthr.school_three_pingtai_id
        WHERE le.mm_emp_type = '1' and lmanager.lat_company != ''
        <!--<if test="school_id != null and school_id != ''">-->
        <!--and le.school_id=#{school_id}-->
        <!--</if>-->
        <if test="emp_id != null and emp_id != ''">
            and le.mm_emp_id=#{emp_id}
        </if>
        <if test="gd_type_id != null and gd_type_id != ''">
            and lmanager.gd_type_id=#{gd_type_id}
        </if>
        <if test="keyWords != null and keyWords != ''">
            AND le.mm_emp_nickname like CONCAT('%',#{keyWords},'%')
        </if>

        <!--<if test="lat != null and lat != '' and lng != null and lng != ''">-->
            <!--order by ACOS(SIN((#{lat} * 3.1415) / 180 ) *SIN((lat_company * 3.1415) / 180 ) +COS((#{lat} * 3.1415) / 180 ) * COS((lat_company * 3.1415) / 180 ) *COS((#{lng}* 3.1415) / 180 - (lng_company * 3.1415) / 180 ) ) * 6380 asc-->
        <!--</if>-->

        limit #{index},#{size}
    </select>

    <update id="updateBgMine" parameterType="com.liangxunwang.unimanager.model.Emp">
        UPDATE mm_emp SET
        mm_emp_bg=#{mm_emp_bg}
        WHERE mm_emp_id=#{mm_emp_id}
    </update>

</mapper>